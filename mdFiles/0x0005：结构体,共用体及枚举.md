# 结构体简介



## 概念引入

有时候我们要存储一组数据，这些数据是互相有关系的。例如，一个商品，它的名字、价格和存量是有联系的，如果我们要存储它们，就得需要三个变量：
```c++
double price;
string name;	
int count;
```

当商品多起来的时候，就得开三个数组来分别存储它们了，这似乎有点麻烦。

那么，能否有一种数据格式，可以将所有这些信息存储在一个单元中呢？答案是有的，叫做 **结构体** 。结构是一种比数组更灵活的数据格式，因为同一个结构可以存储多种类型的数据，将数据的表示合并到一起。如果要存储很多商品的信息，则可以使用结构体数组。

结构也是C++OOP（类）的基石，学习有关结构的知识将使我们离C++的核心OOP更近一步。

## 初识结构

接下来，我们将通过一个程序片段，来认识C++结构体是怎么被初始化和访问的：

```c++
/*
* 作者：Zeroize
* IDE：VisualStudio2022
*/
#include <iostream>
#include <string>

using namespace std;

/*	 结构体的声明	  */
struct myStruct
{
	string name;
	double val;
};

int main() {
	/*  结构体变量的定义与初始化  */
	myStruct good1 =
	{
		"Good1",	//name
		2.33		//val
	};
	//当然，我们也能简化格式
	myStruct good2 = { "Good2", 5.21 };

	/*  结构体变量的使用  */
	//使用 "." 来访问结构体good1的各个成员
	cout << good1.name << " 's price is " << good1.val << " $\n";
	//结构体之间可以用 = 来赋值
	myStruct good3 = good2;
	cout << good3.name << " 's price is " << good3.val << " $\n";

	return 0;
}

//运行结果
Good1 's price is 2.33 $
Good2 's price is 5.21 $
```

### 结构体的声明与定义

常见的结构体的声明与定义有以下两种：

```c
//声明与定义分开
struct structName
{
    类型1 成员1;
    类型2 成员2;
    ......
};
structName myStru1;
//声明与定义在一起
struct structName
{
    类型1 成员1;
    类型2 成员2;
    ......
} myStru1;
```

除此之外，结构类型的名称也可以省略，只不过这样做的话，以后就会无法再次创建这种类型的变量：

```c++
struct
{
    类型1 成员1;
    类型2 成员2;
    ......
} myStru2;
```

### 结构体变量的初始化和赋值

C++11支持将列表初始化用于结构，且等号是可选的：

```c++
structName myStru1 = {"lalala", 233, ...};
structName myStru1 {"lalala", 233, ...};
//若大括号无内容，各个成员都将被设置为零
structName myStru1 {};//"", 0, ...
```

结构体变量间可以直接通过 `= `来赋值：

```c++
structName myStru1 = {"lalala", 233, ...};
structName stillStru1 = myStru1;
```

### 结构体成员的访问

我们可以使用 `.` 来访问结构体变量的成员：

```c++
//访问了good1变量的string类型的name成员和int类型的val成员
cout << good1.name << " 's price is " << good1.val << " $\n";
```

### 结构体数组

结构体也是可以创建数组的：

```c++
structName myStruArr[100];
cout << myStruArr[3].number1 << " " << myStruArr[3].number2 << " ......";
```

其实，除了以上这些基本特性，C++结构还可以拥有成员函数。但这些高级特性通常被用在类中，因此将在后续学习类的时候在介绍。

---

# 共用体简介

## 概念

与结构体类似，共用体也能够存储不同的数据类型，但 **只能同时存储其中的一种类型**。也就是说，结构体可以同时存储int 和 long 和 double，而共用体只能存储int 或 long 或 double。由于共用体每次只能存储一个值，因此它必须有足够大的空间来存储最大的成员，因此，共用体的长度为其最大成员的长度。

共用体通常的用途就是节省空间和内存，当数据项使用两种或更多格式（不会同时使用）时，可以节省空间和内存。

## 使用

共用体的声明与初始化：

```c++
union one4all
{
    int intVal;
    long longVal;
}
one4all var1;
var1.intVal = 15;	//现在存储的是int变量intVal
var1.longVal = 20;	//现在存储的是long变量longVal，intVal被丢失
```

将共用体应用到结构体中，可以节省一定程度的空间，我们只需要确认当前结构体中，哪个共用体变量是活动的即可：

```c++
struct widget
{
    string brand;
    int type;	//区分共用体变量
    union
    {
        long id_num;
        string id_name;
    }
}
...
widget prize;
...
if (prize.type == 1)
    cin >> prize.id_num;
else
    cin >> prize.id_name;
```

---

# 枚举简介

## 初识枚举

C++的 enum 工具提供了另一种创建符号常量的方式，这种方式可以代替 const 。它还允许定义新类型，但必须按照严格的限制进行。使用 enum 的语法和使用结构体相似：

```c++
enum number {zero, one, two, three};
```

此语句将完成两个工作：

- 让 number 成为新类型的名称，被称为枚举。
- 让zero，one，two等作为符号常量，对应整数值0~3.

在默认情况下，枚举量的第一个值为0，之后递增。但也能显式地指定某些枚举量为某些整数值。

## 使用枚举

使用枚举时，我们只需注意一句话：**枚举量是一个特殊的整型，可以转换为int类型，但int类型不能自动转换为枚举类型**。

```c++
//声明枚举number类的变量
number num;
//给num赋值
number = one;	//正确的，one是number的枚举量
number = 1;		//错误的，int不能转换为枚举类型
```

我们还能自定义枚举量的值，让它不是从0到n：

```c++
enum bits {one = 1, two = 2, four = 4, eight = 8};
```

